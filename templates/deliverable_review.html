{% extends "base.html" %}
{% block title %}查看結案檔案{% endblock %}
{% block content %}
<div class="card">
    <h2>{{ project.title }} - 結案檔案</h2>
    
    {% if deliverables %}
        <h3>歷史版本</h3>
        {% for d in deliverables %}
            <div style="margin-bottom:1rem;padding:0.5rem;border:1px solid #ddd;">
                <p><strong>檔案名稱:</strong> {{ d.file_name }}</p>
                <p><strong>說明:</strong> {{ d.message }}</p>
                <p><strong>上傳時間:</strong> {{ d.uploaded_at }}</p>
                <p><a href="/{{ d.file_path }}" target="_blank" class="btn">下載檔案</a></p>
            </div>
        {% endfor %}

        {% if (project.status == 'assigned' or project.status == 'rejected') %}
        <div style="margin-top: 2rem;">
            <form method="POST" action="/client/project/{{ project.id }}/complete" style="display: inline;">
                <button type="submit" class="btn btn-success">接受結案</button>
            </form>
            <form method="POST" action="/client/project/{{ project.id }}/reject" style="display: inline;">
                <button type="submit" class="btn btn-danger">退件</button>
            </form>
        </div>
        {% endif %}
    {% else %}
        <p>接案人尚未上傳結案檔案</p>
    {% endif %}
</div>

<a href="/client/dashboard" class="btn">返回</a>
{% endblock %}